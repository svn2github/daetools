<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="Generator" content="Kate, the KDE Advanced Text Editor" />
<title>tutorial_cv_4.py</title>
</head>
<!-- Highlighting: "Python" -->
<body>
<pre style='color:#1f1c1b;background-color:#ffffff;'>
<span style='color:#017a31;'>#!/usr/bin/env python</span>
<span style='color:#017a31;'># -*- coding: utf-8 -*-</span>

<span style='color:#017a31;'>&quot;&quot;&quot;</span>
<span style='color:#017a31;'>***********************************************************************************</span>
<span style='color:#017a31;'>                           tutorial_cv_4.py</span>
<span style='color:#017a31;'>                DAE Tools: pyDAE module, www.daetools.com</span>
<span style='color:#017a31;'>                Copyright (C) Dragan Nikolic</span>
<span style='color:#017a31;'>***********************************************************************************</span>
<span style='color:#017a31;'>DAE Tools is free software; you can redistribute it and/or modify it under the</span>
<span style='color:#017a31;'>terms of the GNU General Public License version 3 as published by the Free Software</span>
<span style='color:#017a31;'>Foundation. DAE Tools is distributed in the hope that it will be useful, but WITHOUT</span>
<span style='color:#017a31;'>ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A</span>
<span style='color:#017a31;'>PARTICULAR PURPOSE. See the GNU General Public License for more details.</span>
<span style='color:#017a31;'>You should have received a copy of the GNU General Public License along with the</span>
<span style='color:#017a31;'>DAE Tools software; if not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span style='color:#017a31;'>************************************************************************************</span>
<span style='color:#017a31;'>&quot;&quot;&quot;</span>
__doc__ <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc0000;'>&quot;&quot;&quot;</span>
<span style='color:#cc0000;'>Code verification using the Method of Manufactured Solutions.</span>

<span style='color:#cc0000;'>Reference: </span>

<span style='color:#cc0000;'>1. K. Salari and P. Knupp. Code Verification by the Method of Manufactured Solutions. </span>
<span style='color:#cc0000;'>   SAND2000 â€“ 1444 (2000).</span>
<span style='color:#cc0000;'>   `doi:10.2172/759450 &lt;https://doi.org/10.2172/759450&gt;`_</span>

<span style='color:#cc0000;'>The problem in this tutorial is the *transient convection-diffusion* equation </span>
<span style='color:#cc0000;'>distributed on a rectangular 2D domain with u and v components of velocity:</span>
<span style='color:#cc0000;'>    </span>
<span style='color:#cc0000;'>.. code-block:: none</span>

<span style='color:#cc0000;'>   L(u) = du/dt + (d(uu)/dx + d(uv)/dy) - ni * (d2u/dx2 + d2u/dy2) = 0</span>
<span style='color:#cc0000;'>   L(v) = dv/dt + (d(vu)/dx + d(vv)/dy) - ni * (d2v/dx2 + d2v/dy2) = 0</span>

<span style='color:#cc0000;'>The manufactured solutions are: </span>
<span style='color:#cc0000;'>    </span>
<span style='color:#cc0000;'>.. code-block:: none</span>

<span style='color:#cc0000;'>   um = u0 * (sin(x**2 + y**2 + w0*t) + eps)</span>
<span style='color:#cc0000;'>   vm = v0 * (cos(x**2 + y**2 + w0*t) + eps)</span>

<span style='color:#cc0000;'>The terms in the new sources Su and Sv are computed using the daetools derivative </span>
<span style='color:#cc0000;'>functions (dt, d and d2).</span>

<span style='color:#cc0000;'>Again, the Dirichlet boundary conditions are used:</span>
<span style='color:#cc0000;'>    </span>
<span style='color:#cc0000;'>.. code-block:: none</span>

<span style='color:#cc0000;'>   u(LB, y)  = um(LB, y)</span>
<span style='color:#cc0000;'>   u(UB, y)  = um(UB, y)</span>
<span style='color:#cc0000;'>   u(x,  LB) = um(x,  LB)</span>
<span style='color:#cc0000;'>   u(x,  UB) = um(x,  UB)</span>

<span style='color:#cc0000;'>   v(LB, y)  = vm(LB, y)</span>
<span style='color:#cc0000;'>   v(UB, y)  = vm(UB, y)</span>
<span style='color:#cc0000;'>   v(x,  LB) = vm(x,  LB)</span>
<span style='color:#cc0000;'>   v(x,  UB) = vm(x,  UB)</span>

<span style='color:#cc0000;'>Numerical vs. manufactured solution plot (u velocity component, 40x32 grid):</span>

<span style='color:#cc0000;'>.. image:: _static/tutorial_cv_4-results.png</span>
<span style='color:#cc0000;'>   :width: 500px</span>

<span style='color:#cc0000;'>The normalised global errors and the order of accuracy plots </span>
<span style='color:#cc0000;'>(grids 10x8, 20x16, 40x32, 80x64):</span>

<span style='color:#cc0000;'>.. image:: _static/tutorial_cv_4-results2.png</span>
<span style='color:#cc0000;'>   :width: 800px</span>
<span style='color:#cc0000;'>&quot;&quot;&quot;</span>

<span style='color:#3605fb;'>import</span> sys, numpy
<span style='color:#3605fb;'>from</span> time <span style='color:#3605fb;'>import</span> localtime, strftime
<span style='color:#3605fb;'>import</span> matplotlib.pyplot <span style='color:#3605fb;'>as</span> plt
<span style='color:#3605fb;'>from</span> daetools.pyDAE <span style='color:#3605fb;'>import</span> <b><span style='color:#0000ff;'>*</span></b>
<span style='color:#3605fb;'>from</span> daetools.solvers.superlu <span style='color:#3605fb;'>import</span> pySuperLU

no_t <b><span style='color:#0000ff;'>=</span></b> daeVariableType(<span style='color:#cc0000;'>&quot;no_t&quot;</span>, dimless, <b><span style='color:#0000ff;'>-</span></b><span style='color:#cc047c;'>1.0e+20</span>, <span style='color:#cc047c;'>1.0e+20</span>, <span style='color:#cc047c;'>0.0</span>, <span style='color:#cc047c;'>1e-6</span>)

<b>class</b> modTutorial(daeModel):
    <b>def</b> <b><span style='color:#000e52;'>__init__</span></b>(<span style='color:#3605fb;'>self</span>, Name, Parent <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>None</span>, Description <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc0000;'>&quot;&quot;</span>):
        daeModel.<b><span style='color:#000e52;'>__init__</span></b>(<span style='color:#3605fb;'>self</span>, Name, Parent, Description)

        <span style='color:#3605fb;'>self</span>.x  <b><span style='color:#0000ff;'>=</span></b> daeDomain(<span style='color:#cc0000;'>&quot;x&quot;</span>, <span style='color:#3605fb;'>self</span>, m, <span style='color:#cc0000;'>&quot;X axis domain&quot;</span>)
        <span style='color:#3605fb;'>self</span>.y  <b><span style='color:#0000ff;'>=</span></b> daeDomain(<span style='color:#cc0000;'>&quot;y&quot;</span>, <span style='color:#3605fb;'>self</span>, m, <span style='color:#cc0000;'>&quot;Y axis domain&quot;</span>)

        <span style='color:#3605fb;'>self</span>.u0  <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc047c;'>1.0</span>
        <span style='color:#3605fb;'>self</span>.v0  <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc047c;'>1.0</span>
        <span style='color:#3605fb;'>self</span>.w0  <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc047c;'>0.1</span>
        <span style='color:#3605fb;'>self</span>.ni  <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc047c;'>0.7</span>
        <span style='color:#3605fb;'>self</span>.eps <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc047c;'>0.001</span>

        <span style='color:#3605fb;'>self</span>.u  <b><span style='color:#0000ff;'>=</span></b> daeVariable(<span style='color:#cc0000;'>&quot;u&quot;</span>,  no_t, <span style='color:#3605fb;'>self</span>, <span style='color:#cc0000;'>&quot;&quot;</span>, [<span style='color:#3605fb;'>self</span>.x, <span style='color:#3605fb;'>self</span>.y])
        <span style='color:#3605fb;'>self</span>.v  <b><span style='color:#0000ff;'>=</span></b> daeVariable(<span style='color:#cc0000;'>&quot;v&quot;</span>,  no_t, <span style='color:#3605fb;'>self</span>, <span style='color:#cc0000;'>&quot;&quot;</span>, [<span style='color:#3605fb;'>self</span>.x, <span style='color:#3605fb;'>self</span>.y])
        <span style='color:#3605fb;'>self</span>.um <b><span style='color:#0000ff;'>=</span></b> daeVariable(<span style='color:#cc0000;'>&quot;um&quot;</span>, no_t, <span style='color:#3605fb;'>self</span>, <span style='color:#cc0000;'>&quot;&quot;</span>, [<span style='color:#3605fb;'>self</span>.x, <span style='color:#3605fb;'>self</span>.y])
        <span style='color:#3605fb;'>self</span>.vm <b><span style='color:#0000ff;'>=</span></b> daeVariable(<span style='color:#cc0000;'>&quot;vm&quot;</span>, no_t, <span style='color:#3605fb;'>self</span>, <span style='color:#cc0000;'>&quot;&quot;</span>, [<span style='color:#3605fb;'>self</span>.x, <span style='color:#3605fb;'>self</span>.y])

    <b>def</b> DeclareEquations(<span style='color:#3605fb;'>self</span>):
        daeModel.DeclareEquations(<span style='color:#3605fb;'>self</span>)

        <span style='color:#017a31;'># Create some auxiliary functions to make equations more readable </span>
        u0       <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.u0
        v0       <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.v0
        ni       <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.ni
        w0       <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.w0
        eps      <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.eps
        t       <b><span style='color:#0000ff;'>=</span></b> Time()
        
        u       <b><span style='color:#0000ff;'>=</span></b> <b>lambda</b> x,y: <span style='color:#3605fb;'>self</span>.u(x,y)
        v       <b><span style='color:#0000ff;'>=</span></b> <b>lambda</b> x,y: <span style='color:#3605fb;'>self</span>.v(x,y)
        du_dt   <b><span style='color:#0000ff;'>=</span></b> <b>lambda</b> x,y: dt(u(x,y))
        duu_dx  <b><span style='color:#0000ff;'>=</span></b> <b>lambda</b> x,y:  d(u(x,y)<b><span style='color:#0000ff;'>*</span></b>u(x,y), <span style='color:#3605fb;'>self</span>.x)
        duv_dy  <b><span style='color:#0000ff;'>=</span></b> <b>lambda</b> x,y:  d(u(x,y)<b><span style='color:#0000ff;'>*</span></b>v(x,y), <span style='color:#3605fb;'>self</span>.y)
        d2u_dx2 <b><span style='color:#0000ff;'>=</span></b> <b>lambda</b> x,y: d2(u(x,y), <span style='color:#3605fb;'>self</span>.x)
        d2u_dy2 <b><span style='color:#0000ff;'>=</span></b> <b>lambda</b> x,y: d2(u(x,y), <span style='color:#3605fb;'>self</span>.y)
        
        dv_dt   <b><span style='color:#0000ff;'>=</span></b> <b>lambda</b> x,y: dt(v(x,y))
        dvu_dx  <b><span style='color:#0000ff;'>=</span></b> <b>lambda</b> x,y:  d(v(x,y)<b><span style='color:#0000ff;'>*</span></b>u(x,y), <span style='color:#3605fb;'>self</span>.x)
        dvv_dy  <b><span style='color:#0000ff;'>=</span></b> <b>lambda</b> x,y:  d(v(x,y)<b><span style='color:#0000ff;'>*</span></b>v(x,y), <span style='color:#3605fb;'>self</span>.y)
        d2v_dx2 <b><span style='color:#0000ff;'>=</span></b> <b>lambda</b> x,y: d2(v(x,y), <span style='color:#3605fb;'>self</span>.x)
        d2v_dy2 <b><span style='color:#0000ff;'>=</span></b> <b>lambda</b> x,y: d2(v(x,y), <span style='color:#3605fb;'>self</span>.y)

        um       <b><span style='color:#0000ff;'>=</span></b> <b>lambda</b> x,y: u0 <b><span style='color:#0000ff;'>*</span></b> (numpy.sin(x()<b><span style='color:#0000ff;'>**</span></b><span style='color:#cc047c;'>2</span> <b><span style='color:#0000ff;'>+</span></b> y()<b><span style='color:#0000ff;'>**</span></b><span style='color:#cc047c;'>2</span> <b><span style='color:#0000ff;'>+</span></b> w0<b><span style='color:#0000ff;'>*</span></b>t) <b><span style='color:#0000ff;'>+</span></b> eps)
        dum_dt   <b><span style='color:#0000ff;'>=</span></b> <b>lambda</b> x,y: dt(um(x,y))
        dumum_dx <b><span style='color:#0000ff;'>=</span></b> <b>lambda</b> x,y:  d(um(x,y)<b><span style='color:#0000ff;'>*</span></b>um(x,y), <span style='color:#3605fb;'>self</span>.x)
        dumvm_dy <b><span style='color:#0000ff;'>=</span></b> <b>lambda</b> x,y:  d(um(x,y)<b><span style='color:#0000ff;'>*</span></b>vm(x,y), <span style='color:#3605fb;'>self</span>.y)
        d2um_dx2 <b><span style='color:#0000ff;'>=</span></b> <b>lambda</b> x,y: d2(um(x,y), <span style='color:#3605fb;'>self</span>.x)
        d2um_dy2 <b><span style='color:#0000ff;'>=</span></b> <b>lambda</b> x,y: d2(um(x,y), <span style='color:#3605fb;'>self</span>.y)
        
        vm       <b><span style='color:#0000ff;'>=</span></b> <b>lambda</b> x,y: v0 <b><span style='color:#0000ff;'>*</span></b> (numpy.cos(x()<b><span style='color:#0000ff;'>**</span></b><span style='color:#cc047c;'>2</span> <b><span style='color:#0000ff;'>+</span></b> y()<b><span style='color:#0000ff;'>**</span></b><span style='color:#cc047c;'>2</span> <b><span style='color:#0000ff;'>+</span></b> w0<b><span style='color:#0000ff;'>*</span></b>t) <b><span style='color:#0000ff;'>+</span></b> eps)
        dvm_dt   <b><span style='color:#0000ff;'>=</span></b> <b>lambda</b> x,y: dt(vm(x,y))
        dvmum_dx <b><span style='color:#0000ff;'>=</span></b> <b>lambda</b> x,y:  d(vm(x,y)<b><span style='color:#0000ff;'>*</span></b>um(x,y), <span style='color:#3605fb;'>self</span>.x)
        dvmvm_dy <b><span style='color:#0000ff;'>=</span></b> <b>lambda</b> x,y:  d(vm(x,y)<b><span style='color:#0000ff;'>*</span></b>vm(x,y), <span style='color:#3605fb;'>self</span>.y)
        d2vm_dx2 <b><span style='color:#0000ff;'>=</span></b> <b>lambda</b> x,y: d2(vm(x,y), <span style='color:#3605fb;'>self</span>.x)
        d2vm_dy2 <b><span style='color:#0000ff;'>=</span></b> <b>lambda</b> x,y: d2(vm(x,y), <span style='color:#3605fb;'>self</span>.y)
        
        Su       <b><span style='color:#0000ff;'>=</span></b> <b>lambda</b> x,y: dum_dt(x,y) <b><span style='color:#0000ff;'>+</span></b> (dumum_dx(x,y) <b><span style='color:#0000ff;'>+</span></b> dumvm_dy(x,y)) <b><span style='color:#0000ff;'>-</span></b> ni <b><span style='color:#0000ff;'>*</span></b> (d2um_dx2(x,y) <b><span style='color:#0000ff;'>+</span></b> d2um_dy2(x,y))
        Sv       <b><span style='color:#0000ff;'>=</span></b> <b>lambda</b> x,y: dvm_dt(x,y) <b><span style='color:#0000ff;'>+</span></b> (dvmum_dx(x,y) <b><span style='color:#0000ff;'>+</span></b> dvmvm_dy(x,y)) <b><span style='color:#0000ff;'>-</span></b> ni <b><span style='color:#0000ff;'>*</span></b> (d2vm_dx2(x,y) <b><span style='color:#0000ff;'>+</span></b> d2vm_dy2(x,y))

        <span style='color:#017a31;'># Numerical solution</span>
        eq <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.CreateEquation(<span style='color:#cc0000;'>&quot;u&quot;</span>, <span style='color:#cc0000;'>&quot;Numerical solution&quot;</span>)
        x <b><span style='color:#0000ff;'>=</span></b> eq.DistributeOnDomain(<span style='color:#3605fb;'>self</span>.x, eOpenOpen)
        y <b><span style='color:#0000ff;'>=</span></b> eq.DistributeOnDomain(<span style='color:#3605fb;'>self</span>.y, eOpenOpen)
        eq.Residual <b><span style='color:#0000ff;'>=</span></b> du_dt(x,y) <b><span style='color:#0000ff;'>+</span></b> (duu_dx(x,y) <b><span style='color:#0000ff;'>+</span></b> duv_dy(x,y)) <b><span style='color:#0000ff;'>-</span></b> ni <b><span style='color:#0000ff;'>*</span></b> (d2u_dx2(x,y) <b><span style='color:#0000ff;'>+</span></b> d2u_dy2(x,y)) <b><span style='color:#0000ff;'>-</span></b> Su(x,y)
        eq.CheckUnitsConsistency <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>False</span>

        eq <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.CreateEquation(<span style='color:#cc0000;'>&quot;u(,0)&quot;</span>, <span style='color:#cc0000;'>&quot;Numerical solution&quot;</span>)
        x <b><span style='color:#0000ff;'>=</span></b> eq.DistributeOnDomain(<span style='color:#3605fb;'>self</span>.x, eOpenOpen)
        y <b><span style='color:#0000ff;'>=</span></b> eq.DistributeOnDomain(<span style='color:#3605fb;'>self</span>.y, eLowerBound)
        eq.Residual <b><span style='color:#0000ff;'>=</span></b> u(x,y) <b><span style='color:#0000ff;'>-</span></b> um(x,y)
        eq.CheckUnitsConsistency <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>False</span>

        eq <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.CreateEquation(<span style='color:#cc0000;'>&quot;u(,1)&quot;</span>, <span style='color:#cc0000;'>&quot;Numerical solution&quot;</span>)
        x <b><span style='color:#0000ff;'>=</span></b> eq.DistributeOnDomain(<span style='color:#3605fb;'>self</span>.x, eOpenOpen)
        y <b><span style='color:#0000ff;'>=</span></b> eq.DistributeOnDomain(<span style='color:#3605fb;'>self</span>.y, eUpperBound)
        eq.Residual <b><span style='color:#0000ff;'>=</span></b> u(x,y) <b><span style='color:#0000ff;'>-</span></b> um(x,y)
        eq.CheckUnitsConsistency <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>False</span>

        eq <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.CreateEquation(<span style='color:#cc0000;'>&quot;u(0,)&quot;</span>, <span style='color:#cc0000;'>&quot;Numerical solution&quot;</span>)
        x <b><span style='color:#0000ff;'>=</span></b> eq.DistributeOnDomain(<span style='color:#3605fb;'>self</span>.x, eLowerBound)
        y <b><span style='color:#0000ff;'>=</span></b> eq.DistributeOnDomain(<span style='color:#3605fb;'>self</span>.y, eClosedClosed)
        eq.Residual <b><span style='color:#0000ff;'>=</span></b> u(x,y) <b><span style='color:#0000ff;'>-</span></b> um(x,y)
        eq.CheckUnitsConsistency <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>False</span>

        eq <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.CreateEquation(<span style='color:#cc0000;'>&quot;u(1,)&quot;</span>, <span style='color:#cc0000;'>&quot;Numerical solution&quot;</span>)
        x <b><span style='color:#0000ff;'>=</span></b> eq.DistributeOnDomain(<span style='color:#3605fb;'>self</span>.x, eUpperBound)
        y <b><span style='color:#0000ff;'>=</span></b> eq.DistributeOnDomain(<span style='color:#3605fb;'>self</span>.y, eClosedClosed)
        eq.Residual <b><span style='color:#0000ff;'>=</span></b> u(x,y) <b><span style='color:#0000ff;'>-</span></b> um(x,y)
        eq.CheckUnitsConsistency <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>False</span>


        <span style='color:#017a31;'># v component</span>
        eq <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.CreateEquation(<span style='color:#cc0000;'>&quot;v&quot;</span>, <span style='color:#cc0000;'>&quot;Numerical solution&quot;</span>)
        x <b><span style='color:#0000ff;'>=</span></b> eq.DistributeOnDomain(<span style='color:#3605fb;'>self</span>.x, eOpenOpen)
        y <b><span style='color:#0000ff;'>=</span></b> eq.DistributeOnDomain(<span style='color:#3605fb;'>self</span>.y, eOpenOpen)
        eq.Residual <b><span style='color:#0000ff;'>=</span></b> dv_dt(x,y) <b><span style='color:#0000ff;'>+</span></b> (dvu_dx(x,y) <b><span style='color:#0000ff;'>+</span></b> dvv_dy(x,y)) <b><span style='color:#0000ff;'>-</span></b> ni <b><span style='color:#0000ff;'>*</span></b> (d2v_dx2(x,y) <b><span style='color:#0000ff;'>+</span></b> d2v_dy2(x,y)) <b><span style='color:#0000ff;'>-</span></b> Sv(x,y)
        eq.CheckUnitsConsistency <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>False</span>

        eq <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.CreateEquation(<span style='color:#cc0000;'>&quot;v(,0)&quot;</span>, <span style='color:#cc0000;'>&quot;Numerical solution&quot;</span>)
        x <b><span style='color:#0000ff;'>=</span></b> eq.DistributeOnDomain(<span style='color:#3605fb;'>self</span>.x, eOpenOpen)
        y <b><span style='color:#0000ff;'>=</span></b> eq.DistributeOnDomain(<span style='color:#3605fb;'>self</span>.y, eLowerBound)
        eq.Residual <b><span style='color:#0000ff;'>=</span></b> v(x,y) <b><span style='color:#0000ff;'>-</span></b> vm(x,y)
        eq.CheckUnitsConsistency <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>False</span>

        eq <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.CreateEquation(<span style='color:#cc0000;'>&quot;v(,1)&quot;</span>, <span style='color:#cc0000;'>&quot;Numerical solution&quot;</span>)
        x <b><span style='color:#0000ff;'>=</span></b> eq.DistributeOnDomain(<span style='color:#3605fb;'>self</span>.x, eOpenOpen)
        y <b><span style='color:#0000ff;'>=</span></b> eq.DistributeOnDomain(<span style='color:#3605fb;'>self</span>.y, eUpperBound)
        eq.Residual <b><span style='color:#0000ff;'>=</span></b> v(x,y) <b><span style='color:#0000ff;'>-</span></b> vm(x,y)
        eq.CheckUnitsConsistency <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>False</span>

        eq <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.CreateEquation(<span style='color:#cc0000;'>&quot;v(0,)&quot;</span>, <span style='color:#cc0000;'>&quot;Numerical solution&quot;</span>)
        x <b><span style='color:#0000ff;'>=</span></b> eq.DistributeOnDomain(<span style='color:#3605fb;'>self</span>.x, eLowerBound)
        y <b><span style='color:#0000ff;'>=</span></b> eq.DistributeOnDomain(<span style='color:#3605fb;'>self</span>.y, eClosedClosed)
        eq.Residual <b><span style='color:#0000ff;'>=</span></b> v(x,y) <b><span style='color:#0000ff;'>-</span></b> vm(x,y)
        eq.CheckUnitsConsistency <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>False</span>

        eq <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.CreateEquation(<span style='color:#cc0000;'>&quot;v(1,)&quot;</span>, <span style='color:#cc0000;'>&quot;Numerical solution&quot;</span>)
        x <b><span style='color:#0000ff;'>=</span></b> eq.DistributeOnDomain(<span style='color:#3605fb;'>self</span>.x, eUpperBound)
        y <b><span style='color:#0000ff;'>=</span></b> eq.DistributeOnDomain(<span style='color:#3605fb;'>self</span>.y, eClosedClosed)
        eq.Residual <b><span style='color:#0000ff;'>=</span></b> v(x,y) <b><span style='color:#0000ff;'>-</span></b> vm(x,y)
        eq.CheckUnitsConsistency <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>False</span>

        <span style='color:#017a31;'># Manufactured solution</span>
        eq <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.CreateEquation(<span style='color:#cc0000;'>&quot;um&quot;</span>, <span style='color:#cc0000;'>&quot;Manufactured solution&quot;</span>)
        x <b><span style='color:#0000ff;'>=</span></b> eq.DistributeOnDomain(<span style='color:#3605fb;'>self</span>.x, eClosedClosed)
        y <b><span style='color:#0000ff;'>=</span></b> eq.DistributeOnDomain(<span style='color:#3605fb;'>self</span>.y, eClosedClosed)
        eq.Residual <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.um(x,y) <b><span style='color:#0000ff;'>-</span></b> um(x,y)
        eq.CheckUnitsConsistency <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>False</span>

        eq <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.CreateEquation(<span style='color:#cc0000;'>&quot;vm&quot;</span>, <span style='color:#cc0000;'>&quot;Manufactured solution&quot;</span>)
        x <b><span style='color:#0000ff;'>=</span></b> eq.DistributeOnDomain(<span style='color:#3605fb;'>self</span>.x, eClosedClosed)
        y <b><span style='color:#0000ff;'>=</span></b> eq.DistributeOnDomain(<span style='color:#3605fb;'>self</span>.y, eClosedClosed)
        eq.Residual <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.vm(x,y) <b><span style='color:#0000ff;'>-</span></b> vm(x,y)
        eq.CheckUnitsConsistency <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>False</span>

<b>class</b> simTutorial(daeSimulation):
    <b>def</b> <b><span style='color:#000e52;'>__init__</span></b>(<span style='color:#3605fb;'>self</span>, Nx, Ny):
        daeSimulation.<b><span style='color:#000e52;'>__init__</span></b>(<span style='color:#3605fb;'>self</span>)
        <span style='color:#3605fb;'>self</span>.m <b><span style='color:#0000ff;'>=</span></b> modTutorial(<span style='color:#cc0000;'>&quot;tutorial_cv_4(</span><span style='color:#cc0000;'>%d</span><span style='color:#cc0000;'>x</span><span style='color:#cc0000;'>%d</span><span style='color:#cc0000;'>)&quot;</span> <b><span style='color:#0000ff;'>%</span></b> (Nx,Ny))
        <span style='color:#3605fb;'>self</span>.m.Description <b><span style='color:#0000ff;'>=</span></b> __doc__
        
        <span style='color:#3605fb;'>self</span>.Nx <b><span style='color:#0000ff;'>=</span></b> Nx
        <span style='color:#3605fb;'>self</span>.Ny <b><span style='color:#0000ff;'>=</span></b> Ny

    <b>def</b> SetUpParametersAndDomains(<span style='color:#3605fb;'>self</span>):
        <span style='color:#3605fb;'>self</span>.m.x.CreateStructuredGrid(<span style='color:#3605fb;'>self</span>.Nx, <b><span style='color:#0000ff;'>-</span></b><span style='color:#cc047c;'>0.1</span>, <span style='color:#cc047c;'>0.7</span>)
        <span style='color:#3605fb;'>self</span>.m.y.CreateStructuredGrid(<span style='color:#3605fb;'>self</span>.Ny,  <span style='color:#cc047c;'>0.2</span>, <span style='color:#cc047c;'>0.8</span>)
        
    <b>def</b> SetUpVariables(<span style='color:#3605fb;'>self</span>):
        Nx <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.m.x.NumberOfPoints
        Ny <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.m.y.NumberOfPoints
        
        xp <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.m.x.Points
        yp <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.m.y.Points
        
        u0       <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.m.u0
        v0       <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.m.v0
        eps      <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.m.eps
        
        um0 <b><span style='color:#0000ff;'>=</span></b> <b>lambda</b> x,y: u0 <b><span style='color:#0000ff;'>*</span></b> (numpy.sin(x<b><span style='color:#0000ff;'>**</span></b><span style='color:#cc047c;'>2</span> <b><span style='color:#0000ff;'>+</span></b> y<b><span style='color:#0000ff;'>**</span></b><span style='color:#cc047c;'>2</span>) <b><span style='color:#0000ff;'>+</span></b> eps)
        vm0 <b><span style='color:#0000ff;'>=</span></b> <b>lambda</b> x,y: v0 <b><span style='color:#0000ff;'>*</span></b> (numpy.cos(x<b><span style='color:#0000ff;'>**</span></b><span style='color:#cc047c;'>2</span> <b><span style='color:#0000ff;'>+</span></b> y<b><span style='color:#0000ff;'>**</span></b><span style='color:#cc047c;'>2</span>) <b><span style='color:#0000ff;'>+</span></b> eps)
        
        <b>for</b> x <b>in</b> <span style='color:#2a00d6;'>range</span>(<span style='color:#cc047c;'>1</span>, Nx<b><span style='color:#0000ff;'>-</span></b><span style='color:#cc047c;'>1</span>):
            <b>for</b> y <b>in</b> <span style='color:#2a00d6;'>range</span>(<span style='color:#cc047c;'>1</span>, Ny<b><span style='color:#0000ff;'>-</span></b><span style='color:#cc047c;'>1</span>):
                <span style='color:#3605fb;'>self</span>.m.u.SetInitialCondition(x,y, um0(xp[x], yp[y]))
                <span style='color:#3605fb;'>self</span>.m.v.SetInitialCondition(x,y, vm0(xp[x], yp[y]))
                
<span style='color:#017a31;'># Setup everything manually and run in a console</span>
<b>def</b> simulate(Nx, Ny):
    <span style='color:#017a31;'># Create Log, Solver, DataReporter and Simulation object</span>
    log          <b><span style='color:#0000ff;'>=</span></b> daePythonStdOutLog()
    daesolver    <b><span style='color:#0000ff;'>=</span></b> daeIDAS()
    datareporter <b><span style='color:#0000ff;'>=</span></b> daeDelegateDataReporter()
    simulation   <b><span style='color:#0000ff;'>=</span></b> simTutorial(Nx, Ny)

    <span style='color:#017a31;'># Do no print progress</span>
    log.PrintProgress <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>False</span>

    lasolver <b><span style='color:#0000ff;'>=</span></b> pySuperLU.daeCreateSuperLUSolver()
    daesolver.SetLASolver(lasolver)

    <span style='color:#017a31;'># Enable reporting of all variables</span>
    simulation.m.SetReportingOn(<span style='color:#3605fb;'>True</span>)

    <span style='color:#017a31;'># Enable reporting of time derivatives for all reported variables</span>
    simulation.ReportTimeDerivatives <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>True</span>

    <span style='color:#017a31;'># Set the time horizon and the reporting interval</span>
    simulation.ReportingInterval <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc047c;'>2</span>
    simulation.TimeHorizon <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc047c;'>90</span>

    <span style='color:#017a31;'># Connect data reporter</span>
    simName <b><span style='color:#0000ff;'>=</span></b> simulation.m.Name <b><span style='color:#0000ff;'>+</span></b> strftime(<span style='color:#cc0000;'>&quot; [</span><span style='color:#cc0000;'>%d</span><span style='color:#cc0000;'>.%m.%Y %H:%M:%S]&quot;</span>, localtime())

    <span style='color:#017a31;'># 1. TCP/IP</span>
    tcpipDataReporter <b><span style='color:#0000ff;'>=</span></b> daeTCPIPDataReporter()
    datareporter.AddDataReporter(tcpipDataReporter)
    <b>if</b> <b>not</b> tcpipDataReporter.Connect(<span style='color:#cc0000;'>&quot;&quot;</span>, simName):
        sys.exit()

    <span style='color:#017a31;'># 2. Data</span>
    dr <b><span style='color:#0000ff;'>=</span></b> daeNoOpDataReporter()
    datareporter.AddDataReporter(dr)

    <span style='color:#017a31;'># Initialize the simulation</span>
    simulation.Initialize(daesolver, datareporter, log)

    <span style='color:#017a31;'># Save the model report and the runtime model report</span>
    <span style='color:#017a31;'>#simulation.m.SaveModelReport(simulation.m.Name + &quot;.xml&quot;)</span>
    <span style='color:#017a31;'>#simulation.m.SaveRuntimeModelReport(simulation.m.Name + &quot;-rt.xml&quot;)</span>

    <span style='color:#017a31;'># Solve at time=0 (initialization)</span>
    simulation.SolveInitial()

    <span style='color:#017a31;'># Run</span>
    simulation.Run()
    simulation.Finalize()
    
    
    <span style='color:#017a31;'>########################################</span><span style='color:#81ca2d;'>###</span>
    <span style='color:#017a31;'>#  Data                                   #</span>
    <span style='color:#017a31;'>########################################</span><span style='color:#81ca2d;'>###</span>
    results <b><span style='color:#0000ff;'>=</span></b> dr.Process.dictVariables
    uvar <b><span style='color:#0000ff;'>=</span></b> results[simulation.m.Name <b><span style='color:#0000ff;'>+</span></b> <span style='color:#cc0000;'>'.u'</span>]
    vvar <b><span style='color:#0000ff;'>=</span></b> results[simulation.m.Name <b><span style='color:#0000ff;'>+</span></b> <span style='color:#cc0000;'>'.v'</span>]
    umvar <b><span style='color:#0000ff;'>=</span></b> results[simulation.m.Name <b><span style='color:#0000ff;'>+</span></b> <span style='color:#cc0000;'>'.um'</span>]
    vmvar <b><span style='color:#0000ff;'>=</span></b> results[simulation.m.Name <b><span style='color:#0000ff;'>+</span></b> <span style='color:#cc0000;'>'.vm'</span>]
    times <b><span style='color:#0000ff;'>=</span></b> uvar.TimeValues
    u  <b><span style='color:#0000ff;'>=</span></b> uvar.Values[<b><span style='color:#0000ff;'>-</span></b><span style='color:#cc047c;'>1</span>, :, :]  <span style='color:#017a31;'># 3D array [t,x,y]</span>
    v  <b><span style='color:#0000ff;'>=</span></b> vvar.Values[<b><span style='color:#0000ff;'>-</span></b><span style='color:#cc047c;'>1</span>, :, :]  <span style='color:#017a31;'># 3D array [t,x,y]</span>
    um <b><span style='color:#0000ff;'>=</span></b> umvar.Values[<b><span style='color:#0000ff;'>-</span></b><span style='color:#cc047c;'>1</span>, :, :] <span style='color:#017a31;'># 3D array [t,x,y]</span>
    vm <b><span style='color:#0000ff;'>=</span></b> vmvar.Values[<b><span style='color:#0000ff;'>-</span></b><span style='color:#cc047c;'>1</span>, :, :] <span style='color:#017a31;'># 3D array [t,x,y]</span>
    
    <b>return</b> times,u,v,um,vm

<b>def</b> run(guiRun <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>False</span>, qtApp <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>None</span>):
    Nxs <b><span style='color:#0000ff;'>=</span></b> numpy.array([<span style='color:#cc047c;'>10</span>, <span style='color:#cc047c;'>20</span>, <span style='color:#cc047c;'>40</span>, <span style='color:#cc047c;'>80</span>])
    Nys <b><span style='color:#0000ff;'>=</span></b> numpy.array([<span style='color:#cc047c;'>8</span>, <span style='color:#cc047c;'>16</span>, <span style='color:#cc047c;'>32</span>, <span style='color:#cc047c;'>64</span>])
    n <b><span style='color:#0000ff;'>=</span></b> <span style='color:#2a00d6;'>len</span>(Nxs)
    Lx <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc047c;'>0.8</span>
    hs <b><span style='color:#0000ff;'>=</span></b> Lx <b><span style='color:#0000ff;'>/</span></b> Nxs <span style='color:#017a31;'># It's similar in y direction</span>
    Eu <b><span style='color:#0000ff;'>=</span></b> numpy.zeros(n)
    Ev <b><span style='color:#0000ff;'>=</span></b> numpy.zeros(n)
    Cu <b><span style='color:#0000ff;'>=</span></b> numpy.zeros(n)
    Cv <b><span style='color:#0000ff;'>=</span></b> numpy.zeros(n)
    pu <b><span style='color:#0000ff;'>=</span></b> numpy.zeros(n)
    pv <b><span style='color:#0000ff;'>=</span></b> numpy.zeros(n)
    E2 <b><span style='color:#0000ff;'>=</span></b> numpy.zeros(n)
    
    <span style='color:#017a31;'># The normalised global errors</span>
    <b>for</b> i <b>in</b> <span style='color:#2a00d6;'>range</span>(n):
        Nx <b><span style='color:#0000ff;'>=</span></b> <span style='color:#2a00d6;'>int</span>(Nxs[i])
        Ny <b><span style='color:#0000ff;'>=</span></b> <span style='color:#2a00d6;'>int</span>(Nys[i])
        times, u, v, um, vm <b><span style='color:#0000ff;'>=</span></b> simulate(Nx, Ny)
        Eu[i] <b><span style='color:#0000ff;'>=</span></b> numpy.sqrt((<span style='color:#cc047c;'>1.0</span><b><span style='color:#0000ff;'>/</span></b>(Nx<b><span style='color:#0000ff;'>*</span></b>Ny)) <b><span style='color:#0000ff;'>*</span></b> numpy.<span style='color:#2a00d6;'>sum</span>((u<b><span style='color:#0000ff;'>-</span></b>um)<b><span style='color:#0000ff;'>**</span></b><span style='color:#cc047c;'>2</span>))
        Ev[i] <b><span style='color:#0000ff;'>=</span></b> numpy.sqrt((<span style='color:#cc047c;'>1.0</span><b><span style='color:#0000ff;'>/</span></b>(Nx<b><span style='color:#0000ff;'>*</span></b>Ny)) <b><span style='color:#0000ff;'>*</span></b> numpy.<span style='color:#2a00d6;'>sum</span>((v<b><span style='color:#0000ff;'>-</span></b>vm)<b><span style='color:#0000ff;'>**</span></b><span style='color:#cc047c;'>2</span>))

    <span style='color:#017a31;'># Order of accuracy</span>
    <b>for</b> i,Nx <b>in</b> <span style='color:#2a00d6;'>enumerate</span>(Nxs):
        <b>if</b> i <b><span style='color:#0000ff;'>==</span></b> <span style='color:#cc047c;'>0</span>:
            pu[i] <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc047c;'>0</span>
            pv[i] <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc047c;'>0</span>
            Cu[i] <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc047c;'>0</span>
            Cv[i] <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc047c;'>0</span>
        <b>else</b>:
            pu[i] <b><span style='color:#0000ff;'>=</span></b> numpy.log(Eu[i]<b><span style='color:#0000ff;'>/</span></b>Eu[i<b><span style='color:#0000ff;'>-</span></b><span style='color:#cc047c;'>1</span>]) <b><span style='color:#0000ff;'>/</span></b> numpy.log(hs[i]<b><span style='color:#0000ff;'>/</span></b>hs[i<b><span style='color:#0000ff;'>-</span></b><span style='color:#cc047c;'>1</span>])
            pv[i] <b><span style='color:#0000ff;'>=</span></b> numpy.log(Ev[i]<b><span style='color:#0000ff;'>/</span></b>Ev[i<b><span style='color:#0000ff;'>-</span></b><span style='color:#cc047c;'>1</span>]) <b><span style='color:#0000ff;'>/</span></b> numpy.log(hs[i]<b><span style='color:#0000ff;'>/</span></b>hs[i<b><span style='color:#0000ff;'>-</span></b><span style='color:#cc047c;'>1</span>])
            Cu[i] <b><span style='color:#0000ff;'>=</span></b> Eu[i] <b><span style='color:#0000ff;'>/</span></b> hs[i]<b><span style='color:#0000ff;'>**</span></b>pu[i]
            Cv[i] <b><span style='color:#0000ff;'>=</span></b> Ev[i] <b><span style='color:#0000ff;'>/</span></b> hs[i]<b><span style='color:#0000ff;'>**</span></b>pv[i]
        
    C2u <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc047c;'>0.030</span> <span style='color:#017a31;'># constant for the second order slope line (to get close to the actual line)</span>
    C2v <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc047c;'>0.075</span> <span style='color:#017a31;'># constant for the second order slope line (to get close to the actual line)</span>
    Eu2 <b><span style='color:#0000ff;'>=</span></b> C2u <b><span style='color:#0000ff;'>*</span></b> hs<b><span style='color:#0000ff;'>**</span></b><span style='color:#cc047c;'>2</span> <span style='color:#017a31;'># Eu for the second order slope</span>
    Ev2 <b><span style='color:#0000ff;'>=</span></b> C2v <b><span style='color:#0000ff;'>*</span></b> hs<b><span style='color:#0000ff;'>**</span></b><span style='color:#cc047c;'>2</span> <span style='color:#017a31;'># Ev for the second order slope</span>
    
    fontsize <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc047c;'>14</span>
    fontsize_legend <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc047c;'>11</span>
    fig <b><span style='color:#0000ff;'>=</span></b> plt.figure(figsize<b><span style='color:#0000ff;'>=</span></b>(<span style='color:#cc047c;'>10</span>,<span style='color:#cc047c;'>8</span>), facecolor<b><span style='color:#0000ff;'>=</span></b><span style='color:#cc0000;'>'white'</span>)
    grids <b><span style='color:#0000ff;'>=</span></b> [<span style='color:#cc0000;'>'</span><span style='color:#cc0000;'>%d</span><span style='color:#cc0000;'>x</span><span style='color:#cc0000;'>%d</span><span style='color:#cc0000;'>'</span> <b><span style='color:#0000ff;'>%</span></b> (Nx,Ny) <b>for</b> (Nx,Ny) <b>in</b> <span style='color:#2a00d6;'>zip</span>(Nxs,Nys)]
    grids <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc0000;'>','</span>.join(grids)
    fig.canvas.set_window_title(<span style='color:#cc0000;'>'The Normalised global errors and the Orders of accuracy (grids: </span><span style='color:#cc0000;'>%s</span><span style='color:#cc0000;'>)'</span> <b><span style='color:#0000ff;'>%</span></b> grids)
    
    ax <b><span style='color:#0000ff;'>=</span></b> plt.subplot(<span style='color:#cc047c;'>221</span>)
    plt.figure(<span style='color:#cc047c;'>1</span>, facecolor<b><span style='color:#0000ff;'>=</span></b><span style='color:#cc0000;'>'white'</span>)
    plt.loglog(hs, Eu,  <span style='color:#cc0000;'>'ro'</span>, label<b><span style='color:#0000ff;'>=</span></b><span style='color:#cc0000;'>'Eu(h)'</span>)
    plt.loglog(hs, Eu2, <span style='color:#cc0000;'>'b-'</span>, label<b><span style='color:#0000ff;'>=</span></b><span style='color:#cc0000;'>'2nd order slope'</span>)
    plt.xlabel(<span style='color:#cc0000;'>'h'</span>, fontsize<b><span style='color:#0000ff;'>=</span></b>fontsize)
    plt.ylabel(<span style='color:#cc0000;'>'||Eu||'</span>, fontsize<b><span style='color:#0000ff;'>=</span></b>fontsize)
    plt.legend(fontsize<b><span style='color:#0000ff;'>=</span></b>fontsize_legend)
    <span style='color:#017a31;'>#plt.xlim((0.0, 0.09))</span>
        
    ax <b><span style='color:#0000ff;'>=</span></b> plt.subplot(<span style='color:#cc047c;'>222</span>)
    plt.figure(<span style='color:#cc047c;'>1</span>, facecolor<b><span style='color:#0000ff;'>=</span></b><span style='color:#cc0000;'>'white'</span>)
    plt.semilogx(hs[<span style='color:#cc047c;'>1</span>:], pu[<span style='color:#cc047c;'>1</span>:],  <span style='color:#cc0000;'>'rs-'</span>, label<b><span style='color:#0000ff;'>=</span></b><span style='color:#cc0000;'>'Order of Accuracy (pu)'</span>)
    plt.xlabel(<span style='color:#cc0000;'>'h'</span>, fontsize<b><span style='color:#0000ff;'>=</span></b>fontsize)
    plt.ylabel(<span style='color:#cc0000;'>'pu'</span>, fontsize<b><span style='color:#0000ff;'>=</span></b>fontsize)
    plt.legend(fontsize<b><span style='color:#0000ff;'>=</span></b>fontsize_legend)
    <span style='color:#017a31;'>#plt.xlim((0.0, 0.09))</span>
    plt.ylim((<span style='color:#cc047c;'>1.94</span>, <span style='color:#cc047c;'>2.02</span>))
    
    ax <b><span style='color:#0000ff;'>=</span></b> plt.subplot(<span style='color:#cc047c;'>223</span>)
    plt.figure(<span style='color:#cc047c;'>1</span>, facecolor<b><span style='color:#0000ff;'>=</span></b><span style='color:#cc0000;'>'white'</span>)
    plt.loglog(hs, Ev,  <span style='color:#cc0000;'>'ro'</span>, label<b><span style='color:#0000ff;'>=</span></b><span style='color:#cc0000;'>'Ev(h)'</span>)
    plt.loglog(hs, Ev2, <span style='color:#cc0000;'>'b-'</span>, label<b><span style='color:#0000ff;'>=</span></b><span style='color:#cc0000;'>'2nd order slope'</span>)
    plt.xlabel(<span style='color:#cc0000;'>'h'</span>, fontsize<b><span style='color:#0000ff;'>=</span></b>fontsize)
    plt.ylabel(<span style='color:#cc0000;'>'||Ev||'</span>, fontsize<b><span style='color:#0000ff;'>=</span></b>fontsize)
    plt.legend(fontsize<b><span style='color:#0000ff;'>=</span></b>fontsize_legend)
    <span style='color:#017a31;'>#plt.xlim((0.0, 0.09))</span>
        
    ax <b><span style='color:#0000ff;'>=</span></b> plt.subplot(<span style='color:#cc047c;'>224</span>)
    plt.figure(<span style='color:#cc047c;'>1</span>, facecolor<b><span style='color:#0000ff;'>=</span></b><span style='color:#cc0000;'>'white'</span>)
    plt.semilogx(hs[<span style='color:#cc047c;'>1</span>:], pv[<span style='color:#cc047c;'>1</span>:],  <span style='color:#cc0000;'>'rs-'</span>, label<b><span style='color:#0000ff;'>=</span></b><span style='color:#cc0000;'>'Order of Accuracy (pv)'</span>)
    plt.xlabel(<span style='color:#cc0000;'>'h'</span>, fontsize<b><span style='color:#0000ff;'>=</span></b>fontsize)
    plt.ylabel(<span style='color:#cc0000;'>'pv'</span>, fontsize<b><span style='color:#0000ff;'>=</span></b>fontsize)
    plt.legend(fontsize<b><span style='color:#0000ff;'>=</span></b>fontsize_legend)
    <span style='color:#017a31;'>#plt.xlim((0.0, 0.09))</span>
    plt.ylim((<span style='color:#cc047c;'>1.94</span>, <span style='color:#cc047c;'>2.02</span>))

    plt.tight_layout()
    plt.show()

<b>if</b> <span style='color:#3605fb;'>__name__</span> <b><span style='color:#0000ff;'>==</span></b> <span style='color:#cc0000;'>&quot;__main__&quot;</span>:
    run()
</pre>
</body>
</html>
